---
title: "Reproducible Research: Peer Assessment 1"
author: "Jose Mari"
date: "16 de agosto de 2015"
output: html_document
---


## Loading and preprocessing the data

    1. Load the data (i.e. read.csv())

    2. Process/transform the data (if necessary) into a format suitable for your analysis


```{r echo = TRUE}
data <- na.omit(read.csv("activity.csv", colClasses = c("numeric", "Date", "numeric")))
```


## What is mean total number of steps taken per day?

    1. Make a histogram of the total number of steps taken each day

```{r fig.width=10, fig.height=5, echo = TRUE}
totalStepsPerday <- aggregate(steps ~ date, data, sum)
hist(totalStepsPerday$steps,  breaks = 20, main="DISTRIBUTION OF STEPS PER DAY", , ylab = "FREQUENCY OF STEPS", xlab = "STEPS", col="purple")
```

    2. Calculate and report the mean and median total number of steps taken per day

* Mean Steps Per Day
```{r echo = TRUE}
mean(totalStepsPerday$steps)
```

* Median Steps Per Day
```{r echo = TRUE}
median(totalStepsPerday$steps, na.rm=FALSE)
```

## What is the average daily activity pattern?

    1. Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, 
    averaged across all days (y-axis)

```{r fig.width=10, fig.height=5, echo = TRUE}
plot(aggregate(steps ~ date, data, mean), col="red", xlab="DATA", ylab="STEPS", lwd = 3, main="Average daily activity pattern", type="l")
```


2. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?

```{r echo = TRUE}
maxSteps <- max((aggregate(steps ~ interval, data, mean))$steps)
intervals <- aggregate(steps ~ interval, data, mean)
intervals[intervals$steps == maxSteps,]$interval
```



